set -e

track_last_command() {
    last_command=$current_command
    current_command=$BASH_COMMAND
}
trap track_last_command DEBUG

echo_failed_command() {
    local failed="$?"
	if [[ "$failed" != "0" ]]; then
		echo "'$last_command': command failed with exit code $failed."
	fi
}
trap echo_failed_command EXIT
